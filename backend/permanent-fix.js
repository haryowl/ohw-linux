const fs = require("fs");let content = fs.readFileSync("src/routes/records.js", "utf8");// Step 1: Add authentication imports (only if not already present)if (!content.includes("const { requireAuth } = require('./auth');")) {  content = content.replace("const ExcelJS = require('exceljs');", "const ExcelJS = require('exceljs');\nconst { requireAuth } = require('./auth');\nconst { filterDevicesByPermission } = require('../middleware/permissions');");}// Step 2: Add authentication to export-sm endpoint (only if not already present)if (!content.includes("router.post('/export-sm', requireAuth, filterDevicesByPermission, async (req, res) => {")) {  content = content.replace("router.post('/export-sm', async (req, res) => {", "router.post('/export-sm', requireAuth, filterDevicesByPermission, async (req, res) => {");}// Step 3: Remove the problematic Device include completelycontent = content.replace(/include: \[\{[\s\S]*?model: require\('\.\.\/models'\)\.Device[\s\S]*?\}\]/g, "");// Step 4: Also remove any remaining Device include referencescontent = content.replace(/include: \[\{[\s\S]*?model: require\('\.\.\/models'\)\.Device[\s\S]*?\}\]/g, "");fs.writeFileSync("src/routes/records.js", content);console.log("? PERMANENT FIX APPLIED: Added auth + Removed Device include"); 
